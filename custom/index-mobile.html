<!DOCTYPE html>
<html>

<head>
    <title></title>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <link rel="stylesheet" href="//code.jquery.com/ui/1.11.4/themes/smoothness/jquery-ui.css">
    <link rel="stylesheet" href="http://static.tumblr.com/e6lc7yi/z3pnekdqv/precrafted-social.css">
    <link rel="stylesheet" href="http://static.tumblr.com/e6lc7yi/g6Fnsuud3/fixie-styles.css">
    <!--bootstrap css-->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-drawer/1.0.6/css/bootstrap-drawer.min.css">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans+Condensed:300' rel='stylesheet' type='text/css'>
    <script src="//code.jquery.com/jquery-1.10.2.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>
    <script src="//code.jquery.com/ui/1.11.4/jquery-ui.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-drawer/1.0.6/js/drawer.min.js"></script>
    <script type="text/javascript" src="http://woolito.tumblr.com/api/read/json"></script>
    <script type="text/javascript" src="https://www.youtube.com/iframe_api"></script>
    <script src="http://static.tumblr.com/sirdwhf/VFqo9dynz/youtube.js"></script>
</head>
<style type="text/css">
body{
    background-color: #e3e3e3;
}
/* drawer */
.drawer-body{
    padding: 0px;
}
header{
    padding: 0px;
    background-color: #fff;
}
/* Navigation */
div.center{
    padding-top: 0px;
    padding-left: 0px;
}
.logo a {
    color: #000;
    text-decoration: none;
}
header .logo h1 a{
    font-size: 30px;
}
header p.description {
    margin: 0px;
}
#navigation ul li{
    border-top: 5px #ddd solid;
    width: 90%;
    margin: 0px auto;
    font-size: 16px;
    line-height: 40px;
    text-align: left;
}
#navigation ul li a {
    margin-left: 70px;
    color: #000;
}
#shortcut {
    background-color: #fff;
    padding: 20px;
    border-radius: 10px 10px 50px 10px;
}
.social_network{
    margin-bottom: 40px;
    padding: 10px;
}
.social_network img {
    display: inline;
    height: 50px;
    width: auto;
}
/* container header */
.container {
    padding-left: 0px;
    padding-right: 0px;
    background-color: #e3e3e3;
}

#header {
    background-color: #fff;
    display: table;
    padding: 10px 0px;
}

#header .drawer_icon {
    display: table-cell;
    vertical-align: middle;
}

#header .title {
    display: table-cell;
    width: 100%;
    text-align: center;
    font-size: 1.5em;
    text-transform: uppercase;
}

/* top post */
section{
    margin-bottom: 40px;
}
#top{
    width: 100%;
    display: block;
}
.top-post{
    width: 100%;
    display: block;
    margin: 2px;
}
.top-post a{
    display: block;
    padding: 1.2%;
    background-color: #fff;
    margin: 0px 5px 0px 5px;
}
.top-post a img{
    width: 100%;
    height: auto;
}
/* posts-holder */

/* grid-item */
.grid-item{
    padding: 20px;
    margin: 5px;
    background-color: #fff;
}
.grid-item iframe, .grid-item img{
    width: 100%;
}
/* youtube */
.post_iframe{
    position: relative;
    height: auto;
}
div.play-button { 
    height: 72px; 
    width: 72px;
    position: absolute;
    top: 50%;
    left: 50%;
    margin-top: -36px;
    margin-left: -36px;
    background: url("http://i.imgur.com/TxzC70f.png");
    background-repeat: no-repeat;
    cursor: pointer;
}
#product_video iframe{
    width: 90%;
    margin-bottom: 3%;
}
.labnolIframe{
    width: 100%;
    height: 100%;
}
</style>

<body class="has-drawer">
    <div id="drawerExample" class="drawer dw-xs-10 dw-sm-6 dw-md-4 fold" aria-labelledby="drawerExample">
        <div class="drawer-controls">
            <a href="#drawerExample" data-toggle="drawer" aria-foldedopen="false" aria-controls="drawerExample" class="btn btn-primary btn-sm"><span class="glyphicon glyphicon-menu-hamburger" aria-hidden="true"></span></a>
        </div>
        <div class="drawer-contents">
            <div class="drawer-body">
                <header>
                    <div class="center">
                        <div class="centered">
                            <div id="shortcut">
                                <div class="avatar">
                                    <a href="/" title="Woolito Studio" class="avatar circle">
                                        <img src="http://67.media.tumblr.com/avatar_fbc2eabcb706_128.png" alt="Woolito Studio" class="default">
                                    </a>
                                </div>
                                <div class="logo">
                                    <h1><a href="/" title="Woolito Studio">Woolito Studio</a></h1>
                                </div>
                                <p class="description">我們努力創作有趣的動畫與圖文並分享笑容</p>
                                <p class="description">希望能為彼此的生活點綴</p>
                                <p class="description">一些無厘頭的樂趣！</p>
                            </div>

                            <div id="navigation">
                                <ul>
                                    <li>
                                        <a href="contact">
                                            <span class="label-chinese">
                                                聯繫我們</span>
                                            <span class="label-english">Contact</span>
                                        </a>
                                    </li>
                                    <li>
                                        <a href="aboutus">
                                            <span class="label-chinese">
                                                關於我們</span>
                                            <span class="label-english">About Woolito</span>
                                        </a>
                                    </li>
                                    <li>
                                        <a href="service">
                                            <span class="label-chinese">
                                                商業服務</span>
                                            <span class="label-english">Service</span>
                                        </a>
                                    </li>
                                    <li>
                                        <a href="works">
                                            <span class="label-chinese">
                                                作品集</span>
                                            <span class="label-english">Works</span>
                                        </a>
                                    </li>
                                    <li>
                                        <a href="shop">
                                            <span class="label-chinese">
                                                原創商品</span>
                                            <span class="label-english">Shop</span>
                                        </a>
                                    </li>
                                    <li>
                                        <a href="line">
                                            <span class="label-chinese">
                                                LINE 貼圖</span>
                                            <span class="label-english">LINE Sticker</span>
                                        </a>
                                    </li>
                                </ul>
                            </div>

                            <div class="social_network">
                                <img src="http://static.tumblr.com/sirdwhf/fz1o96e68/facebook.png">
                                <img src="http://static.tumblr.com/sirdwhf/ZqHo96e6b/youtube.png">
                                <img src="http://static.tumblr.com/sirdwhf/WG8o96e6e/line.png">
                                <img src="http://static.tumblr.com/sirdwhf/Ls8o96e6n/instagram.png">
                            </div>
                        </div>
                    </div>
                </header>
            </div>
        </div>
    </div>
    <div class="container">
        
        <section class="top-posts index">
            <div id="top">
                <div class="top-post">
                    <a href="works"><img src="http://static.tumblr.com/3hbpjha/b3Co7if6f/top-works.png"></a>
                </div>
                <div class="top-post">
                    <a href="aboutus"><img src="http://static.tumblr.com/3hbpjha/D5Eo7if68/top-about.png"></a>
                    <a href="service"><img src="http://static.tumblr.com/3hbpjha/Pxjo7if6c/top-service.png"></a>
                    <a href="contact"><img src="http://static.tumblr.com/3hbpjha/wlmo7if6a/top-contact.png"></a>
                </div>
            </div>
            <div class="grid">
                <div class="grid-sizer"></div>

            </div>
        </section>
    </div>
</body>
<script type="text/javascript">
var posts;
var current_posts_number = 6;
$(function() {
    judge_window_size();
    $( window ).resize(function() {
        judge_window_size();
    });

    query_posts("");
});

function judge_window_size(){
    var width = $(window).width();
    var href = location.href;
    // var index = href.lastIndexOf("/")+1;
    // href = href.substring(index);
    console.log(width + ", " + href);
    if(width <= 400 && href == "http://woolito.tumblr.com/"){
        location.href = "index-mobile";
    }else if(width > 400 && href == "http://woolito.tumblr.com/index-mobile"){
        location.href = "http://woolito.tumblr.com/";
    }
}

function readmore() {

}

function query_posts(tag) {
    var posts = [];
    var tags = [];
    $(".grid").html('<div class="grid-sizer"></div>');
    var tumblr_data = tumblr_api_read.posts;
    for (var i = 0; i < tumblr_data.length; i++) {
        if (tag == "") {
            posts = tumblr_data;
            continue;
        }
        try {
            tags = tumblr_data[i].tags;
            if (tags == undefined) {
                tags = [];
            };
            if (tags.indexOf(tag) > -1) {
                posts.push(tumblr_data[i]);
            }
        } catch (err) {
            console.log(err);
            continue;
        }
    }
    if(!posts){
        $("#total_post").text("0");
    }else{
        $("#total_post").text(posts.length);
    }
    render_posts(posts);
}

function render_posts(posts) {
    var grid_holder = $(".grid");

    if (posts.length > 0) {
        for (var i = 0; i < posts.length; i++) {
            var post_type = posts[i].type;
            var post_html = null;
            switch (post_type) {
                case "video":
                    post_html = render_video(posts[i]);
                    break;
                case "regular":
                    post_html = render_text(posts[i]);
                    break;
                case "photo":
                    post_html = render_photo(posts[i]);
                    break;
                default:
                    break;
            }

            $(".grid").append(post_html);
        }
    }
}

function render_photo(post) {
    var article = $("<div></div>");
    article.attr("id", post.id);
    article.addClass("type_photo grid-item");
    article.attr("rel", post['url-with-slug']);
    var article_content = $('<div class="article-content"></div>');
    var photo_wrap = $('<div class="photo-wrap post"></div>');
    var photo_post = $('<div class="photo--post"></div>')
    var photo_link = $('<a href="' + post['url-with-slug'] + '"></a>')
    var photo_img = $('<img src="' + post['photo-url-400'] + '" data-highres="' + post['photo-url-1280'] + '" alt="' + post.slug + '">')
    photo_link.append(photo_img);
    photo_post.append(photo_link);
    photo_wrap.append(photo_post);
    var caption = $('<div class="caption">' + post['photo-caption'] + '</div>');
    article_content.append(photo_wrap).append(caption);
    var icon = render_icon(post);
    article_content.append(icon);
    article.append(article_content);
    return article;
}

function render_video(post) {
    var article = $("<div></div>");
    article.attr("id", post.id);
    article.addClass("type_video grid-item");
    article.attr("rel", post['url-with-slug']);
    var article_content = $('<div class="article-content"></div>');
    var video_stage = $("<div class='video-stage'></div>");
    var video_container = $("<div class='video-container ready video' id='" + post.id + "'></div>");
    var iframe = render_iframe(post);

    // var shortcut = video_shortcut(post);
    // video_container.append(shortcut);

    video_container.append(iframe);
    video_stage.append(video_container);
    var caption = $('<div class="caption">' + post['video-caption'] + '</div>');
    article_content.append(video_stage).append(caption);
    var icon = render_icon(post);
    article_content.append(icon);
    article.append(article_content);
    return article;
}

function render_text(post) {
    var article = $("<div></div>");
    article.attr("id", post.id);
    article.addClass("type_text grid-item");
    article.attr("rel", post['url-with-slug']);
    var article_content = $("<div></div>");
    article_content.addClass("article_content");
    var title = $("<h2></h2>");
    var title_link = $("<a href='" + post['url-with-slug'] + "' title='" + post['regular-title'] + "'>" + post.slug + "</a>");
    title.append(title_link);
    var body = post['regular-body'];
    if (body.indexOf("<!-- more -->") > -1) {
        var start_index = body.indexOf("<!-- more -->");
        body = body.substring(0, start_index);
        body += '<a href="' + post['url-with-slug'] + '">KEEP READING</a>';
    }
    article_content.append(title).append(body);
    var icon = render_icon(post);
    article_content.append(icon);
    article.append(article_content);
    return article;
}

function render_icon(post) {
    var ul = $("<ul class='icons'></ul>");
    var li_link = $('<li class="link"><a href="' + post['url-with-slug'] + '" title="View Post" class="social-eye"></a></li>');
    var li_like = $('<li class="like"><div class="like_button" data-post-id="' + post.id + '" data-blog-name="woolito" id="like_button_' + post.id + '"></div></li>');
    var iframe = $('<iframe id="like_iframe_' + post.id + '" src="http://assets.tumblr.com/assets/html/like_iframe.html?_v=c301660e229be2b44e2e912486577f3c#name=woolito&post_id='+post.id+'&color=black&rk='+post['reblog-key']+'&root_id='+post.id+'" scrolling="no" class="like_toggle" allowtransparency="true" width="16" height="16" frameborder="0" name="like_iframe_'+post.id+'"></iframe>');
    li_like.find(".like_button").append(iframe);
    var li_reblog = $('<li class="reblog"><i class="reblog-icon"><a targer="_blank" href="https://www.tumblr.com/reblog/' + post.id + '/' + post['reblog-key'] + '" class="reblog_button" style="display:block; width:16px; height:16px;"><svg width="100%" height="100%" viewBox="0 0 21 21" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" fill="#000"><path d="M5.01092527,5.99908429 L16.0088498,5.99908429 L16.136,9.508 L20.836,4.752 L16.136,0.083 L16.1360004,3.01110845 L2.09985349,3.01110845 C1.50585349,3.01110845 0.979248041,3.44726568 0.979248041,4.45007306 L0.979248041,10.9999998 L3.98376463,8.30993634 L3.98376463,6.89801007 C3.98376463,6.20867902 4.71892527,5.99908429 5.01092527,5.99908429 Z"></path><path d="M17.1420002,13.2800293 C17.1420002,13.5720293 17.022957,14.0490723 16.730957,14.0490723 L4.92919922,14.0490723 L4.92919922,11 L0.5,15.806 L4.92919922,20.5103758 L5.00469971,16.9990234 L18.9700928,16.9990234 C19.5640928,16.9990234 19.9453125,16.4010001 19.9453125,15.8060001 L19.9453125,9.5324707 L17.142,12.203"></path></svg></a></i></li>');
    var li_share = $('<li class="sharer"><a class="social-export"></a><div class="sharer-wrap"><ul><li class="facebook"><a href="http://www.facebook.com/sharer.php?u=' + post['url-with-slug'] + '" title="Share on Facebook" class="social-facebook" target="_blank" ></a></li><li class="gplus"><a href="https://plus.google.com/share?url=' + post['url-with-slug'] + '" title="Share on Google +" class ="social-gplus" target="_blank"></a></li><li class="pinterest" ><a href="https://pinterest.com/pin/create/button/?url=' + post['url-with-slug'] + '&amp;media=http://67.media.tumblr.com/avatar_fbc2eabcb706_128.png" title="Share on Pinterest" class="social-pinterest" target="_blank"></a></li></ul></div></li>');
    ul.append(li_link).append(li_like).append(li_reblog).append(li_share);
    return ul;
}

function video_shortcut(post) {
    // <img class="labnolIframe" src="https://i.ytimg.com/vi/S2kSogoVzu4/hqdefault.jpg">
    
    // <div id="hospital_m" class="hospital">
        
    //     <div id="youtube_S2kSogoVzu4" class="play-button" onclick="labnolIframe_order('hospital_m', 'S2kSogoVzu4')"></div>
    // </div>
}

function render_iframe(post) {
    var video_source = (post['video-player-250']);

    if (video_source.indexOf("youtube") > -1) {
        video_source = post['video-source'];
        var div_element = $('<div id="iframe_'+post.id+'" class="post_iframe">');
        var start_index = video_source.lastIndexOf("/")+1;
        var youtube_id = video_source.substring(start_index);
        var img_element = $('<img class="labnolIframe" src="https://i.ytimg.com/vi/'+youtube_id+'/hqdefault.jpg">');
        var click_element = $('<div class="play-button" onclick="labnolIframe_order(\'iframe_'+post.id+'\', \''+youtube_id+'\')"></div>');
        div_element.append(img_element).append(click_element);
        return div_element;
    }

    var url = 'https://www.tumblr.com/video/woolito/' + post.id + '/700/'
    var html = $('<iframe src="' + url + '" class="embed_iframe tumblr_video_iframe" scrolling="no" frameborder="0" data-can-gutter data-can-resize allowfullscreen mozallowfunscreen webkitallowfullscreen></iframe>');
    return html;
}
</script>

</html>
